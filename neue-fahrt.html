<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neue Fahrt - BW Fahrschul-Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Verstecke Standard-Radiobuttons */
        input[type="radio"].ampel-radio { display: none; }
        /* Styling für Ampel-Buttons */
        input[type="radio"].ampel-radio:checked + label {
            opacity: 1;
            transform: scale(1.1);
            border-color: #1e293b; 
            border-width: 2px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .ampel-label { opacity: 0.3; transition: all 0.2s ease-in-out; }
    </style>
</head>
<body class="bg-gray-100 text-slate-800 font-sans antialiased pb-10">

    <div class="max-w-2xl mx-auto bg-white min-h-screen shadow-2xl relative flex flex-col">

        <header class="bg-slate-800 text-white p-4 sticky top-0 z-50 shadow-md flex items-center">
            <button onclick="window.location.href='index.html'" type="button" class="mr-4 p-2 bg-slate-700 rounded-full hover:bg-slate-600 active:scale-95">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
            </button>
            <div>
                <h1 class="text-xl font-bold tracking-wide">Fahrt dokumentieren</h1>
                <p class="text-xs text-slate-300">Curricularer Leitfaden C/CE & Stufenplan</p>
            </div>
        </header>

        <main class="flex-1 p-5">
            <form id="fahrtForm" onsubmit="saveFahrt(event)">
                
                <section class="mb-8">
                    <h2 class="text-lg font-bold text-blue-900 mb-3 border-b-2 border-blue-200 pb-1">1. Stammdaten (Anonymisiert)</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wide">Schüler-ID</label>
                            <select name="schuelerId" required class="w-full p-3 rounded-xl border border-slate-300 bg-slate-50 font-bold text-slate-700">
                                <option value="" disabled selected>Auswählen...</option>
                                <option value="S-2026-04">S-2026-04</option>
                                <option value="S-2026-09">S-2026-09</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wide">Klasse</label>
                            <select name="klasse" required class="w-full p-3 rounded-xl border border-slate-300 bg-slate-50 font-bold text-slate-700">
                                <option value="C">Klasse C</option>
                                <option value="CE">Klasse CE</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wide">Dauer (Min)</label>
                            <input type="number" name="dauer" value="90" required class="w-full p-3 rounded-xl border border-slate-300 bg-slate-50 font-bold text-slate-700">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1 uppercase tracking-wide">Datum</label>
                            <input type="date" name="datum" id="heute" required class="w-full p-3 rounded-xl border border-slate-300 bg-slate-50 font-bold text-slate-700">
                        </div>
                    </div>
                </section>

                <section class="mb-8">
                    <h2 class="text-lg font-bold text-blue-900 mb-3 border-b-2 border-blue-200 pb-1">2. Stufenplan (FahrschAusbO)</h2>
                    <select name="ausbildungsstufe" required class="w-full p-3 rounded-xl border border-slate-300 bg-slate-50 font-bold text-slate-700 mb-3">
                        <option value="" disabled selected>Aktuelle Stufe wählen...</option>
                        <optgroup label="Reguläre Stufen">
                            <option value="Grundstufe">Grundstufe (Einweisung, Bedienung)</option>
                            <option value="Aufbaustufe">Aufbaustufe (Einfache Verkehrssituationen)</option>
                            <option value="Leistungsstufe">Leistungsstufe (Schwierige Verkehrssituationen)</option>
                            <option value="Reifestufe">Reifestufe (Prüfungsvorbereitung)</option>
                        </optgroup>
                        <optgroup label="Besondere Ausbildungsfahrten">
                            <option value="Ueberland">Überlandfahrt (B 12)</option>
                            <option value="Autobahn">Autobahnfahrt (B 13)</option>
                            <option value="Dunkelheit">Fahrt bei Dunkelheit (B 14)</option>
                        </optgroup>
                    </select>
                </section>

                <section class="mb-8">
                    <h2 class="text-lg font-bold text-blue-900 mb-1 border-b-2 border-blue-200 pb-1">3. Kompetenzbewertung (C/CE)</h2>
                    <p class="text-xs text-slate-500 mb-4 bg-slate-100 p-2 rounded">
                        <span class="font-bold text-red-600">Rot:</span> Eingreifen nötig / Grobe Mängel &bull; 
                        <span class="font-bold text-yellow-600">Gelb:</span> Hilfestellung nötig &bull; 
                        <span class="font-bold text-green-600">Grün:</span> Selbstständig / Prüfungsreif
                    </p>

                    <div class="mb-6 bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-700 mb-3 uppercase text-xs tracking-wider">A. Vorbereitung & Technik</h3>
                        
                        <div class="flex items-center justify-between mb-3 border-b border-slate-200 pb-2">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Abfahrtskontrolle (StVZO)</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_abfahrtskontrolle" id="abf_rot" value="rot" class="ampel-radio"><label for="abf_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_abfahrtskontrolle" id="abf_gelb" value="gelb" class="ampel-radio"><label for="abf_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_abfahrtskontrolle" id="abf_gruen" value="gruen" class="ampel-radio"><label for="abf_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between border-b border-slate-200 pb-2 mb-3">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Trennen & Verbinden (inkl. Leitungen)</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_trennen" id="trenn_rot" value="rot" class="ampel-radio"><label for="trenn_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_trennen" id="trenn_gelb" value="gelb" class="ampel-radio"><label for="trenn_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_trennen" id="trenn_gruen" value="gruen" class="ampel-radio"><label for="trenn_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>

                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Fahrzeugbedienung (Retarder, Motorbremse, Getriebe)</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_bedienung" id="bed_rot" value="rot" class="ampel-radio"><label for="bed_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_bedienung" id="bed_gelb" value="gelb" class="ampel-radio"><label for="bed_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_bedienung" id="bed_gruen" value="gruen" class="ampel-radio"><label for="bed_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-700 mb-3 uppercase text-xs tracking-wider">B. Grundfahraufgaben</h3>
                        
                        <div class="flex items-center justify-between border-b border-slate-200 pb-2 mb-3">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Rückwärtsfahren (Gliederzug/Sattel)</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_rueckwaerts" id="rueck_rot" value="rot" class="ampel-radio"><label for="rueck_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_rueckwaerts" id="rueck_gelb" value="gelb" class="ampel-radio"><label for="rueck_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_rueckwaerts" id="rueck_gruen" value="gruen" class="ampel-radio"><label for="rueck_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>

                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium text-slate-800 w-2/3">An die Rampe setzen / Einweisen lassen</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_rampe" id="ramp_rot" value="rot" class="ampel-radio"><label for="ramp_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_rampe" id="ramp_gelb" value="gelb" class="ampel-radio"><label for="ramp_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_rampe" id="ramp_gruen" value="gruen" class="ampel-radio"><label for="ramp_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-6 bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm">
                        <h3 class="font-bold text-slate-700 mb-3 uppercase text-xs tracking-wider">C. Fahren im Verkehr</h3>
                        
                        <div class="flex items-center justify-between border-b border-slate-200 pb-2 mb-3">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Verkehrsbeobachtung / Spiegel (Toter Winkel!)</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_spiegel" id="spiegel_rot" value="rot" class="ampel-radio"><label for="spiegel_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_spiegel" id="spiegel_gelb" value="gelb" class="ampel-radio"><label for="spiegel_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_spiegel" id="spiegel_gruen" value="gruen" class="ampel-radio"><label for="spiegel_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>

                        <div class="flex items-center justify-between border-b border-slate-200 pb-2 mb-3">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Fahrbahnplatzierung & Ausschwenken beim Abbiegen</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_abbiegen" id="ab_rot" value="rot" class="ampel-radio"><label for="ab_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_abbiegen" id="ab_gelb" value="gelb" class="ampel-radio"><label for="ab_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_abbiegen" id="ab_gruen" value="gruen" class="ampel-radio"><label for="ab_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>

                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium text-slate-800 w-2/3">Vorausschauendes & Ökologisches Fahren</span>
                            <div class="flex space-x-3 w-1/3 justify-end">
                                <input type="radio" name="bew_oeko" id="oeko_rot" value="rot" class="ampel-radio"><label for="oeko_rot" class="ampel-label w-8 h-8 rounded-full bg-red-500 cursor-pointer"></label>
                                <input type="radio" name="bew_oeko" id="oeko_gelb" value="gelb" class="ampel-radio"><label for="oeko_gelb" class="ampel-label w-8 h-8 rounded-full bg-yellow-400 cursor-pointer"></label>
                                <input type="radio" name="bew_oeko" id="oeko_gruen" value="gruen" class="ampel-radio"><label for="oeko_gruen" class="ampel-label w-8 h-8 rounded-full bg-green-500 cursor-pointer"></label>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mb-8">
                    <h2 class="text-lg font-bold text-blue-900 mb-3 border-b-2 border-blue-200 pb-1">4. Pädagogische Notizen</h2>
                    <textarea name="notizen" rows="4" placeholder="Beobachtungen für die Nachbesprechung (ohne Klarnamen!). Z.B.: 'Schüler vergisst oft die Vorwahlgruppe am Getriebe, Fokus nächste Stunde.'" class="w-full p-4 rounded-xl border border-slate-300 focus:ring-2 focus:ring-blue-500 bg-slate-50 text-slate-800 shadow-inner"></textarea>
                </section>

                <button type="submit" class="w-full bg-blue-700 text-white font-bold text-xl py-5 rounded-xl shadow-lg hover:bg-blue-800 active:scale-95 transition-all flex justify-center items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                    Fahrt sicher lokal speichern
                </button>
            </form>
        </main>
    </div>

    <script>
        // Setze das heutige Datum automatisch in das Datumsfeld ein
        document.getElementById('heute').valueAsDate = new Date();

        function saveFahrt(event) {
            event.preventDefault(); // Verhindert Neuladen
            
            // Modernes und dynamisches Auslesen ALLER Formular-Daten
            const formData = new FormData(event.target);
            const fahrtDaten = Object.fromEntries(formData.entries());
            
            // Metadaten hinzufügen
            fahrtDaten.id = "F-" + Date.now(); // Eindeutige ID für diese Fahrt
            fahrtDaten.speicherZeit = new Date().toISOString();

            // Aus dem Local Storage laden
            let gespeicherteFahrten = JSON.parse(localStorage.getItem('bw_fahrten')) || [];
            
            // Neue Fahrt anhängen
            gespeicherteFahrten.push(fahrtDaten);
            
            // Wieder lokal speichern
            localStorage.setItem('bw_fahrten', JSON.stringify(gespeicherteFahrten));

            // Feedback & Weiterleitung
            alert('✅ Ausbildungsinhalte erfolgreich lokal gespeichert!');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
